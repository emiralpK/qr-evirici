<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>QR Chat</title>
<style>
    * {
        box-sizing: border-box;
        font-family: sans-serif;
    }
    body {
        margin: 0;
        padding: 0;
        background: #1f1f1f;
        color: #f0f0f0;
        display: flex;
        height: 100vh;
        overflow: hidden;
        font-family: Arial, sans-serif;
    }
    .container {
        display: flex;
        width: 100%;
        height: 100%;
    }
    .left-panel {
        width: 35%;
        background: #2b2b2b;
        display: flex;
        flex-direction: column;
        padding: 20px;
    }
    .header {
        font-size: 24px;
        margin-bottom: 10px;
        text-align: center;
    }
    .messages {
        flex: 1;
        overflow-y: auto;
        margin-bottom: 20px;
        border: 1px solid #444;
        padding: 10px;
        border-radius: 4px;
    }
    .message {
        background: #3a3a3a;
        padding: 10px;
        border-radius: 4px;
        margin-bottom: 10px;
        word-break: break-word;
    }
    .input-area {
        display: flex;
    }
    .input-area input {
        flex: 1;
        padding: 10px;
        border: 1px solid #444;
        background: #1f1f1f;
        color: #fff;
        border-radius: 4px 0 0 4px;
        outline: none;
    }
    .input-area button {
        padding: 10px;
        border: none;
        background: #ff6b6b;
        color: #fff;
        font-weight: bold;
        cursor: pointer;
        border-radius: 0 4px 4px 0;
    }
    .input-area button:hover {
        background: #ff4b4b;
    }
    .right-panel {
        width: 65%;
        background: #1f1f1f;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        position: relative;
        overflow: hidden;
        padding: 20px;
    }
    .qr-container {
        opacity: 0;
        transform: scale(0.5) rotate(10deg);
        transition: all 0.5s ease;
        background: #ffffff20;
        padding: 40px;
        border-radius: 20px;
        margin-bottom: 20px;
    }
    .qr-container.show {
        opacity: 1;
        transform: scale(1) rotate(0deg);
    }
    .download-area {
        display: flex;
        gap: 10px;
    }
    .download-area button {
        background: #4caf50;
        border: none;
        padding: 10px;
        color: #fff;
        border-radius: 4px;
        cursor: pointer;
    }
    .download-area button:hover {
        background: #45a049;
    }
</style>
</head>
<body>
<div class="container">
    <div class="left-panel">
        <div class="header">Chat - QR Dönüştürücü</div>
        <div class="messages"></div>
        <div class="input-area">
            <input type="text" placeholder="Mesaj yaz..." />
            <button class="send-btn">Gönder</button>
        </div>
    </div>
    <div class="right-panel">
        <div class="qr-container">
            <div id="qrcode"></div>
        </div>
        <div class="download-area">
            <button class="download-png">PNG İndir</button>
            <button class="download-jpg">JPG İndir</button>
        </div>
    </div>
</div>

<!-- qrcode.min.js (David Shim) -->
<script>
/*!
 * QRCode.js v1.0.0
 * https://github.com/davidshimjs/qrcodejs
 * (c) 2016 davidshimjs
 * Released under the MIT license
 */
(function(){function l(a,b){this._el=a;this._htOption=b}function q(a,b){this._oQRCode=new r(a,b);this._oQRCode.make()}function C(a,b){if(a.length<=b)return[a];for(var c=[],d=0;d<a.length;d+=b)c.push(a.slice(d,d+b));return c}function D(a,b){for(var c=a.length,d=0;d<c;d++)if(a[d]==b)return d;return-1}function E(a){this.mode=t.MODE_8BIT_BYTE;this.data=a;this.parsedData=[];for(var b=0;b<this.data.length;b++){var c=this.data.charCodeAt(b);c>255&&console.log("`"+this.data[b]+"` is not supported.");this.parsedData.push(c)}this.getLength=
function(a){return this.parsedData.length};this.write=function(a){for(var c=0;c<this.parsedData.length;c++)a.put(this.parsedData[c],8)}}function u(a,b){this.typeNumber=a;this.errorCorrectLevel=b;this.modules=null;this.moduleCount=0;this.dataCache=null;this.dataList=[];this.addData=function(a){var b=new E(a);this.dataList.push(b);this.dataCache=null};this.isDark=function(a,b){if(this.modules[a][b]!=null)return this.modules[a][b];else throw Error(a+","+b);};this.getModuleCount=function(){return this.moduleCount};
this.make=function(){this.makeImpl(!1,this.getBestMaskPattern())};this.makeImpl=function(a,b){this.moduleCount=4+4*this.typeNumber;this.modules=new Array(this.moduleCount);for(var c=0;c<this.moduleCount;c++){this.modules[c]=new Array(this.moduleCount);for(var d=0;d<this.moduleCount;d++)this.modules[c][d]=null}this.setupPositionProbePattern(0,0);this.setupPositionProbePattern(this.moduleCount-7,0);this.setupPositionProbePattern(0,this.moduleCount-7);this.setupPositionAdjustPattern();this.setupTimingPattern();
this.setupTypeInfo(a,b);this.typeNumber>=7&&this.setupTypeNumber(a);this.dataCache=this.createData(this.typeNumber,this.errorCorrectLevel,this.dataList);this.mapData(this.dataCache,b)};this.setupPositionProbePattern=function(a,b){for(var c=0;7>=c;c++)for(var d=0;7>=d;d++)this.modules[a+d][b+c]=c==0||c==6||d==0||d==6||2<=c&&c<=4&&2<=d&&d<=4};this.getBestMaskPattern=function(){for(var a=0,b=0,c=0;8>c;c++){this.makeImpl(!0,c);var d=w.getLostPoint(this);(c==0||d<b)&&(b=d,a=c)}return a};this.setupTimingPattern=
function(){for(var a=8;a<this.moduleCount-8;a++)null==this.modules[a][6]&&(this.modules[a][6]=a%2==0);for(a=8;a<this.moduleCount-8;a++)null==this.modules[6][a]&&(this.modules[6][a]=a%2==0)};this.setupPositionAdjustPattern=function(){for(var a=w.getPatternPosition(this.typeNumber),b=0;b<a.length;b++)for(var c=0;c<a.length;c++){var d=a[b],e=a[c];if(null==this.modules[d][e])for(var f=-2;2>=f;f++)for(var g=-2;2>=g;g++)this.modules[d+f][e+g]=f== -2||f==2||g== -2||g==2||f==0&&g==0}};this.setupTypeNumber=function(a){var b=w.getBCHTypeNumber(this.typeNumber);
for(var c=0;18>c;c++){var d=!a&&((b>>c)&1)==1;this.modules[Math.floor(c/3)][c%3+this.moduleCount-8-3]=d;this.modules[c%3+this.moduleCount-8-3][Math.floor(c/3)]=d}};this.setupTypeInfo=function(a,b){var c=w.getBCHTypeInfo(this.errorCorrectLevel<<3|b);for(b=0;15>b;b++){var d=!a&&((c>>b)&1)==1;0==b?this.modules[b][8]=d:1==b?this.modules[b][8]=d:2==b?this.modules[b][8]=d:3==b?this.modules[b][8]=d:4==b?this.modules[b][8]=d:5==b?this.modules[b][8]=d:6==b?this.modules[b][8]=d:7==b?this.modules[8][this.moduleCount-7]=d:
8==b?this.modules[8][this.moduleCount-8]=d:9==b?this.modules[8][this.moduleCount-9]=d:10==b?this.modules[8][this.moduleCount-10]=d:11==b?this.modules[this.moduleCount-11][8]=d:12==b?this.modules[this.moduleCount-12][8]=d:13==b?this.modules[this.moduleCount-13][8]=d:14==b&&(this.modules[this.moduleCount-14][8]=d)}this.modules[this.moduleCount-8][8]=!a};this.mapData=function(a,b){for(var c= -1,d=this.moduleCount-1,e=7,f=0;d>0;d-=2){6==d&&d--;for(var g=0;g<this.moduleCount;g++){var h=c<0?this.moduleCount-1-g:g;
if(null==this.modules[d][h]){var k=!1;f<a.length&&(k=((a[f]>>>e)&1)==1);this.modules[d][h]=k;e--; -1==e&&(f++,e=7)}if(null==this.modules[d-1][h]){k=!1;f<a.length&&(k=((a[f]>>>e)&1)==1);this.modules[d-1][h]=k;e--; -1==e&&(f++,e=7)}}c= -c}};this.createData=function(a,b,c){for(var d=x.getRSBlocks(a,b),e=new y,f=0;f<c.length;f++){var g=c[f];e.put(4,4);e.put(g.getLength(),w.getLengthInBits(g.mode,a));g.write(e)}for(f=0;f<4&&!(e.getLengthInBits()>=8*d.totalCount);f++)e.put(0,1);for(;e.getLengthInBits()%8!=0;)e.putBit(!1);
for(;e.getLengthInBits()/8<d.totalCount;)e.put(236,8),e.getLengthInBits()/8<d.totalCount&&e.put(17,8);return z.createBytes(e,d)}};
var A={L:1,M:0,Q:3,H:2},t={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},B={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90]],
G15:(1<<10)+(1<<8)+(1<<5)+(1<<4)+(1<<2)+(1<<1)+(1<<0),G18:(1<<12)+(1<<11)+(1<<10)+(1<<9)+(1<<8)+(1<<5)+(1<<2)+(1<<0),G15_MASK:(1<<14)+(1<<12)+(1<<10)+(1<<4)+(1<<1),getBCHTypeInfo:function(a){for(var b=a<<10;B.getBCHDigit(b)-B.getBCHDigit(B.G15)>=0;)b^=B.G15<<(B.getBCHDigit(b)-B.getBCHDigit(B.G15));return(a<<10|b)^B.G15_MASK},getBCHTypeNumber:function(a){for(var b=a<<12;B.getBCHDigit(b)-B.getBCHDigit(B.G18)>=0;)b^=B.G18<<(B.getBCHDigit(b)-B.getBCHDigit(B.G18));return a<<12|b},getBCHDigit:function(a){for(var b=0;0!=a;)b++,a>>>=1;return b},
getPatternPosition:function(a){return B.PATTERN_POSITION_TABLE[a-1]},getMask:function(a,b,c){switch(a){case 0:return(b+c)%2==0;case 1:return b%2==0;case 2:return c%3==0;case 3:return(b+c)%3==0;case 4:return(Math.floor(b/2)+Math.floor(c/3))%2==0;case 5:return b*c%2+b*c%3==0;case 6:return(b*c%2+b*c%3)%2==0;case 7:return(b*c%3+(b+c)%2)%2==0;default:throw Error("bad maskPattern:"+a);}},getErrorCorrectPolynomial:function(a){for(var b=new F([1],0),c=0;c<a;c++)b=b.multiply(new F([1,G.getGF(1<<(c&255))],0));
return b},getLengthInBits:function(a,b){if(1<=b&&b<10)switch(a){case 1:return 10;case 2:return 9;case 4:return 8;case 8:return 8;default:throw Error("mode:"+a);}else if(b<27)switch(a){case 1:return 12;case 2:return 11;case 4:return 16;case 8:return 10;default:throw Error("mode:"+a);}else if(b<41)switch(a){case 1:return 14;case 2:return 13;case 4:return 16;case 8:return 12;default:throw Error("mode:"+a);}else throw Error("type:"+b);},getLostPoint:function(a){for(var b=a.getModuleCount(),c=0,d=0;d<b;d++)for(var e=0;e<b;e++){for(var f=
0,g=a.isDark(d,e),h= -1;1>=h;h++)for(var k= -1;1>=k;k++)0!=h||0!=k&&d+h>=0&&d+h<b&&e+k>=0&&e+k<b&&g==a.isDark(d+h,e+k)&&f++;f>5&&(c+=3+f-5)}for(d=0;d<b;d++)for(e=0;e<b-6;e++)a.isDark(d,e)&&!a.isDark(d,e+1)&&a.isDark(d,e+2)&&a.isDark(d,e+3)&&a.isDark(d,e+4)&&!a.isDark(d,e+5)&&a.isDark(d,e+6)&& (c+=40);for(e=0;e<b;e++)for(d=0;d<b-6;d++)a.isDark(d,e)&&!a.isDark(d+1,e)&&a.isDark(d+2,e)&&a.isDark(d+3,e)&&a.isDark(d+4,e)&&!a.isDark(d+5,e)&&a.isDark(d+6,e)&&(c+=40);
var m=0;for(d=0;d<b;d++)for(e=0;e<b;e++)a.isDark(d,e)&&m++;b=b*b;return c+=10*Math.abs(100*m/b-50)/5}},w=B,x={getRSBlocks:function(a,b){var c=x.getRsBlockTable(a,b);if(void 0==c)throw Error("bad rs block @ typeNumber:"+a+"/errorCorrectLevel:"+b);for(var d=[],e=0,f=1;f<c.length;f+=3)for(var g=0;g<c[f+2];g++)d.push([c[f],c[f+1]]);return d},getRsBlockTable:function(a,b){switch(b){case A.L:return x.RS_BLOCK_TABLE[4*(a-1)+0];case A.M:return x.RS_BLOCK_TABLE[4*(a-1)+1];case A.Q:return x.RS_BLOCK_TABLE[4*(a-1)+2];case A.H:return x.RS_BLOCK_TABLE[4*(a-1)+3];default:return}}
};
x.RS_BLOCK_TABLE=[1,26,1,1,1,44,1,1,1,70,1,1];var y=function(){this.buffer=[];this.length=0};y.prototype={getBuffer:function(){return this.buffer},get:function(a){return 1==(this.buffer[Math.floor(a/8)]>>7-a%8&1)},put:function(a,b){for(var c=0;c<b;c++)this.putBit((a>>b-c-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(a){this.buffer[Math.floor(this.length/8)]|=a?128>>this.length%8:0;this.length++}};
var z={createBytes:function(a,b){for(var c=0,d=0;d<b.length;d++)c+=b[d][0];for(var e=new Array(c),f=0;f<e.length;f++)e[f]=0;var g=0;for(d=0;d<b.length;d++){var h=b[d][0],k=b[d][1]-h;for(f=0;f<h;f++)e[g++]=255&a.buffer[f];a.buffer.splice(0,h);for(f=0;f<k;f++)e[g++]=255&a.buffer[f];a.buffer.splice(0,k)}return e}},F=function(a,b){var c=0;for(;c<a.length&&0==a[c];)c++;this.num=new Array(a.length-c+b);for(var d=0;d<a.length-c;d++)this.num[d]=a[d+c]},G={gflog:[],gfant:[],init:function(){for(var a=1,b=0;256>b;b++)this.gflog[a]=b,this.gfant[b]=a,a<<=1,a&=255,a&128&&(a^=285)}},H={};
G.init();var I=[0,11,15,19,27,39];l.prototype={makeCode:function(a){this._htOption.text=a;this.make()},make:function(){this._oQRCode=new u(this._getTypeNumber(this._htOption.text,this._htOption.correctLevel),this._htOption.correctLevel);this._oQRCode.addData(this._htOption.text);this._oQRCode.make();this._el.innerHTML="";this._el.appendChild(this._createCanvas())},_createCanvas:function(){var a=document.createElement("canvas"),b=this._oQRCode.getModuleCount(),c=this._oQRCode.getModuleCount(),d=this._htOption.width/
b,e=this._htOption.height/c;a.width=this._htOption.width;a.height=this._htOption.height;for(var f=a.getContext("2d"),g=this._htOption.colorLight,h=this._htOption.colorDark,y=0;y<c;y++)for(var m=0;m<b;m++){f.fillStyle=this._oQRCode.isDark(y,m)?h:g;f.fillRect(m*d,y*e,d,e)}return a},_getTypeNumber:function(a,b){for(var c=1;40>=c;c++){for(var d=0,e=t.MODE_8BIT_BYTE,f=w.getLengthInBits(e,c),g=0;g<a.length;g++){var h=a.charCodeAt(g);h>255&&(d+=2);d++}if(d*8<=f)return c}return null}};window.QRCode=l;
})();
</script>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const input = document.querySelector('.input-area input');
    const sendBtn = document.querySelector('.send-btn');
    const messages = document.querySelector('.messages');
    const qrContainer = document.querySelector('.qr-container');
    const qrcodeEl = document.getElementById('qrcode');
    const downloadPNGBtn = document.querySelector('.download-png');
    const downloadJPGBtn = document.querySelector('.download-jpg');
    let qrcode;

    function generateQR(text) {
        qrcodeEl.innerHTML = '';
        qrContainer.classList.remove('show');
        setTimeout(() => {
            qrcode = new QRCode(qrcodeEl, {
                text: text,
                width: 300,
                height: 300,
                colorDark: "#ffffff",
                colorLight: "#1f1f1f",
                correctLevel: QRCode.CorrectLevel.H
            });
            qrContainer.classList.add('show');
        }, 50);
    }

    sendBtn.addEventListener('click', () => {
        const val = input.value.trim();
        if(val) {
            const msg = document.createElement('div');
            msg.classList.add('message');
            msg.textContent = val;
            messages.appendChild(msg);
            messages.scrollTop = messages.scrollHeight;
            generateQR(val);
            input.value = '';
            input.focus();
        }
    });

    input.addEventListener('keyup', (e) => {
        if(e.key === 'Enter') {
            sendBtn.click();
        }
    });

    function downloadQR(format) {
        // QR kodu üreten canvas elementini bul
        const canvas = qrcodeEl.querySelector('canvas');
        if(!canvas) return;

        let dataURL;
        if(format === 'png') {
            dataURL = canvas.toDataURL('image/png');
        } else {
            // JPEG formatında kalite belirleyebiliriz (0.9 gibi)
            dataURL = canvas.toDataURL('image/jpeg', 0.9);
        }

        const a = document.createElement('a');
        a.href = dataURL;
        a.download = 'qrcode.' + format;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
    }

    downloadPNGBtn.addEventListener('click', () => {
        downloadQR('png');
    });

    downloadJPGBtn.addEventListener('click', () => {
        downloadQR('jpg');
    });
});
</script>
</body>
</html>
